/*!
 * wpdf
 * WP Form Builder
 * https://www.wpformbuilder.com/
 * @author James Collings
 * @version 0.3.1
 * Copyright .  licensed.
 */
!function(a){a.fn.wpdf_reindex_rows=function(){a(this).each(function(b){a(this).find("input[name], select[name], textarea[name]").each(function(){var c;c=a(this).attr("name"),c=c.replace(/field\[[0-9]*\]/g,"field["+b+"]"),a(this).attr("name",c)});var c=a(this).find('input[name$="[order]"]');c.length>0&&c.val(b)})}}(jQuery),function(a){a(document).ready(function(){var b=!1,c=a("#sortable"),d=a(".draggable"),e=a("#sortable .placeholder").text(),f={text:a('#field-placeholder .wpdf-panel[data-field-type="text"]').clone().show(),textarea:a('#field-placeholder .wpdf-panel[data-field-type="textarea"]').clone().show(),select:a('#field-placeholder .wpdf-panel[data-field-type="select"]').clone().show(),checkbox:a('#field-placeholder .wpdf-panel[data-field-type="checkbox"]').clone().show(),radio:a('#field-placeholder .wpdf-panel[data-field-type="radio"]').clone().show(),file:a('#field-placeholder .wpdf-panel[data-field-type="file"]').clone().show()};d.click(function(){var b=f[a(this).data("field")].clone();b.addClass("wpdf-panel--active wpdf-panel--new"),c.append(b),c.find(".wpdf-panel--new").wrap('<li class="draggable ui-state-highlight ui-draggable ui-draggable-handle wpdf-dropped-item"></li>').removeClass("wpdf-panel--new"),a("body").trigger("wpdf_element_added",b),c.find(".placeholder").hide(),c.find("li").wpdf_reindex_rows(),a(document).trigger("wpdf_changed")}),c.sortable({placeholder:"sortable-placeholder",handle:".wpdf-panel__header",items:"li:not(.placeholder)",over:function(){c.find(".placeholder").hide()},out:function(){c.find("li:not(.placeholder)").length<=2&&c.find(".placeholder").show()},stop:function(){c.find(".placeholder").hide()}}),c.disableSelection(),d.draggable({connectToSortable:"#sortable",helper:"clone",revert:"invalid",stop:function(){},start:function(b,c){a(c.helper).width(a(this).width()),a(c.helper).height(a(this).height())}}),c.on("sortreceive",function(c,d){b&&console.log("sortreceive");var e=f[d.item.data("field")].clone();if(e.length>0){a(d.helper).addClass("wpdf-dropped-item"),a(d.helper).html(e);var g=a(d.helper).find(".wpdf-panel").addClass("wpdf-panel--active");a("body").trigger("wpdf_element_added",g)}a(document).trigger("wpdf_changed")}),c.on("sortstop",function(d,e){b&&console.log("sortstop"),a(e.item).height("auto"),a(e.item).width("auto"),b&&console.log("reindex field rows"),c.find("li").wpdf_reindex_rows(),a(document).trigger("wpdf_changed")}),c.on("sortstart",function(c,d){if(b&&console.log("sortstart"),!a(d.item).hasClass("wpdf-dropped-item"))return void console.log("found class!");var f=a(d.item).height();a(d.item).height(f),a(d.item).width(a("#sortable").width()),a("#sortable .sortable-placeholder").height(f).text(e)}),c.find(".placeholder").height(a(".wpdf-cols").height()-40),c.find("li.ui-state-default").length>0&&c.find(".placeholder").hide(),b&&console.log("reindex field rows"),c.find("li").wpdf_reindex_rows()}),a(document).on("click",".wpdf-del-field",function(b){b.preventDefault();var c=confirm("Are you sure you want to delete this field?");if(c){if(a(this).parents("li").remove(),0==a("#sortable li:not(.placeholder)").length){var d=a("#sortable .placeholder");d.height(a(".wpdf-cols").height()-40),d.show()}a(document).trigger("wpdf_changed")}})}(jQuery),function(a){a(document).ready(function(){a(document).on("click",".wpdf-panel__header .wpdf-panel__toggle",function(){a(this).parents(".wpdf-panel").toggleClass("wpdf-panel--active")})})}(jQuery),function(a){a(document).ready(function(){a(document).on("keyup change",".wpdf-input--label",function(){a(this).parents(".wpdf-panel").find(".wpdf-panel__header span.name").text(a(this).val())})})}(jQuery),function(a){var b={},c={},d={};a(document).ready(function(){a(".wpdf-repeater").each(function(){var e=a(this),f=e.data("templateName");void 0==b[f]&&(b[f]=a(e.find("script.wpdf-repeater-template").html()).removeClass("wpdf-repeater__template"));var g=e.data("templateIndex");void 0==c[f]&&(g?c[f]=new RegExp(g):c[f]=/\[[0-9]*\]$/g);var g=e.data("templatePrefix");void 0==d[f]&&(g?d[f]=e.data("templatePrefix"):d[f]=""),e.find(".wpdf-repeater-row").each(function(b){a(this).find("input[name], select[name]").each(function(){var e;e=a(this).attr("name"),e=e.replace(c[f],d[f]+"["+b+"]"),a(this).attr("name",e)})}),e.trigger("wpdf_repeater_init",e)})}),a(document).on("click",".wpdf-add-row",function(e){e.preventDefault();var f=a(this).parents(".wpdf-repeater"),g=f.data("templateName");if(void 0==b[g])return void console.error("Template could not be found, has not been stored in templates array!");var h=f.find(".wpdf-repeater-container"),i=b[g].clone();h.length>0?h.append(i):f.append(i),f.find(".wpdf-repeater-row").each(function(b){a(this).find("input[name], select[name], textarea[name]").each(function(){var e;e=a(this).attr("name"),e=e.replace(c[g],d[g]+"["+b+"]"),a(this).attr("name",e)})}),f.trigger("wpdf_repeater_added"),a("body").trigger("wpdf_element_added",i),a("#sortable li").wpdf_reindex_rows(),a(document).trigger("wpdf_changed")}),a(document).on("click",".wpdf-del-row",function(b){b.preventDefault();var c=a(this).parents(".wpdf-repeater"),d=0;if(c.data("min")&&(d=parseInt(c.data("min"))),c.find(".wpdf-repeater-row").length>d){var e=a(this).parents(".wpdf-repeater-row");e.remove(),c.trigger("wpdf_repeater_removed")}a(document).trigger("wpdf_changed")})}(jQuery),function(a){var b={},c={},d=function(){a(".wpdf-validation-repeater").each(function(){e(a(this))})},e=function(b){b.find(".wpdf-validation-row").each(function(b){a(this).find("input[name], select[name], textarea[name]").each(function(){var c;c=a(this).attr("name"),c=c.replace(/field\[(\d*)\]\[validation\]\[(\d*)\]\[(\w*)\]/g,"field[$1][validation]["+b+"][$3]"),a(this).attr("name",c)})})},f=function(e,f){var g=f.val();b={},e.find(".wpdf-validation-row").each(function(c){var d=a(this).find(".validation_type"),e=d.val();""!==e&&(void 0!==b[e]?b[e]++:b[e]=1)}),""!==g&&b[g]>1&&f.val(""),a(".wpdf-validation-repeater .validation_type option").prop("disabled",!1),a.isEmptyObject(b)||a(".wpdf-validation-repeater .validation_type").each(function(){var c=a(this).val();for(var d in b)d!=c&&a(this).find('option[value="'+d+'"]').prop("disabled",!0)});var h=f.parents(".wpdf-validation-row"),i=f.val(),j=h.data("rule");""!=i&&i!=j&&(h.data("rule",i),void 0!==c[i]&&(h.find(".wpdf-validation__rule").html(c[i]),a("body").trigger("wpdf_element_added",h.find(".wpdf-validation__rule")),a("#sortable li").wpdf_reindex_rows())),""===i&&(h.data("rule",""),h.find(".wpdf-validation__rule").html("")),d()};a(document).ready(function(){a(".wpdf-validation__rule").each(function(){var b=a(this).data("rule");c[b]=a(this).html()})}),a(document).on("wpdf_repeater_init",".wpdf-validation-repeater",function(){var b=a(this);b.find(".wpdf-validation-row").length>0&&e(a(this))}),a(document).on("wpdf_repeater_added",".wpdf-validation-repeater",function(){var b=a(this),c=a(this);f(b,c),a(document).trigger("wpdf_changed")}),a(document).on("wpdf_repeater_removed",".wpdf-validation-repeater",function(){var b=a(this),c=a(this);f(b,c),a(document).trigger("wpdf_changed")}),a(document).on("change",".wpdf-validation-repeater .validation_type",function(){var b=a(this).parents(".wpdf-validation-repeater"),c=a(this);f(b,c)})}(jQuery),function(a){a(document).ready(function(){a(".wpdf-tooltip, .wpdf-tooltip-blank").each(function(){a(this).attr("title").length>0?a(this).tipTip({defaultPosition:"right"}):a(this).hide()}),a("body").on("wpdf_element_added",function(b,c){a(c).find(".wpdf-tooltip, .wpdf-tooltip-blank").each(function(){a(this).attr("title").length>0?a(this).tipTip({defaultPosition:"right"}):a(this).hide()})})})}(jQuery),function(a){var b="wpdf-data__key--set",c=function(a){return a.toLowerCase().replace(/ /g,"_")};a(document).on("change",".wpdf-field__values .wpdf-data__label",function(){var d=a(this).parents(".wpdf-repeater-row"),e=d.find(".wpdf-data__key"),f=d.find(".wpdf-data__default");if(!e.hasClass(b)){var g=c(a(this).val());e.val(g),f.length>0&&f.val(g)}}),a(document).on("change",".wpdf-field__values .wpdf-data__key",function(){a(this).hasClass(b)||a(this).addClass(b)})}(jQuery),function(a){a(document).ready(function(){a(".wpdf-color-picker-input").iris({change:function(b,c){a(this).parent().find(".wpdf-color-pick-preview").css({backgroundColor:c.color.toString()})}}),a(document).click(function(b){if(a(".wpdf-color-picker-input").length>0&&a(".colour-picker, .iris-picker, .iris-picker-inner").is(":visible")&&!a(b.target).is(".colour-picker, .iris-picker, .iris-picker-inner"))return a(".wpdf-color-picker-input").iris("hide"),!1}),a(".wpdf-color-picker-input, .wpdf-color-pick-preview").click(function(b){return a(".wpdf-color-picker-input").iris("hide"),a(this).parent().find(".wpdf-color-picker-input").iris("show"),!1})})}(jQuery),function(a){var b=!1;a(document).on("wpdf_changed",function(){if(!1===b){b=!0;var c=a("#error-wrapper");c.length>0&&c.html('<p class="notice notice-warning wpdf-notice">You have unsaved changes, to save these click the update button.</p>')}}),a(document).on("click",".wpdf-form-manager--inputs input, .wpdf-form-manager--inputs select, .wpdf-form-manager--inputs textarea",function(){a(this).hasClass("wpdf-header__submit")||a(document).trigger("wpdf_changed")}),a(document).on("keyup change",".wpdf-form-manager--inputs input, .wpdf-form-manager--inputs select, .wpdf-form-manager--inputs textarea",function(){a(document).trigger("wpdf_changed")}),a(document).on("click",".wpdf-header__submit",function(){b=!1}),window.onbeforeunload=function(){if(!0===b)return""},a(document).ready(function(){var b=a("#wpdf-form-fields"),c=!1;b.length>0&&a(this).on("submit",function(b){if(a(this).find(".wpdf-col--required").removeClass("wpdf-col--required"),a(this).find(".wpdf-fields .wpdf-input__required").each(function(){""==a(this).val().trim()&&(b.preventDefault(),c=!0,a(this).parents(".wpdf-panel").addClass("wpdf-panel--active"),a(this).parents(".wpdf-col").addClass("wpdf-col--required"))}),c){var d=a("#error-wrapper");d.length>0&&d.html('<p class="notice notice-error wpdf-notice">Please make sure you have filled in all required fields before saving, highlighted in red below.</p>')}})})}(jQuery);